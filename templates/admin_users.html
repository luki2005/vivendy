{% extends "base.html" %}
{% block title %}Admin – Benutzer{% endblock %}
{% block header %}Benutzerverwaltung{% endblock %}

{% block content %}
<table class="user-table">
  <tr>
    <th>Username</th>
    <th>Email</th>
    <th>Status</th>
    <th>Passwort ändern</th>
    <th>Aktion</th>
  </tr>

  {% for u in users %}
  <tr>
    <td>{{ u.username }}</td>
    <td>{{ u.email }}</td>
    <td>
      {% if u.banned %} ❌ Gebannt {% else %} ✔️ Aktiv {% endif %}
    </td>
    <td>
      <form method="post" action="{{ url_for('admin_change_password', user_id=u._id_str) }}">
        <input type="password" name="password" placeholder="Neues Passwort" required>
        <button type="submit">Speichern</button>
      </form>
    </td>
    <td>
      {% if not u.banned %}
        <form method="post" action="{{ url_for('ban_user', user_id=u._id_str) }}">
          <input type="text" name="reason" placeholder="Grund" required>
          <button type="submit">Bannen</button>
        </form>
      {% else %}
        <form method="post" action="{{ url_for('unban_user', user_id=u._id_str) }}">
          <button type="submit">Entbannen</button>
        </form>
      {% endif %}
    </td>
  </tr>
  {% endfor %}
</table>

<h3>E-Mail sperren</h3>
<form method="post" action="{{ url_for('block_email') }}">
  <input type="email" name="email" placeholder="E-Mail" required>
  <input type="text" name="reason" placeholder="Grund">
  <button type="submit">Sperren</button>
</form>
{% endblock %}
